(this["webpackJsonpcoin-trading"]=this["webpackJsonpcoin-trading"]||[]).push([[4],{196:function(e,t,n){"use strict";n.r(t);var c=n(83),a=n(0),r=n(39),u=n(98),i=n(194),o=n(18);function l(e,t){return Object(o.a)(Object(o.a)({},e),t)}function s(){return{data:void 0,error:void 0,completed:!1}}function j(e){var t,n=Object(a.useState)(e),c=Object(u.a)(n,2),r=c[0],i=c[1],o=(t=s,Object(a.useReducer)(l,null,t)),j=Object(u.a)(o,2),b=j[0],d=j[1];return Object(a.useEffect)((function(){if(r){var e=r.subscribe((function(e){d({data:e})}),(function(e){d({error:e})}),(function(){d({completed:!0})}));return function(){d({data:void 0,error:void 0,completed:!1}),e.unsubscribe()}}}),[r,d]),[b,i]}var b=n(93),d=n(126),O=n(147),v=n(185),f=n(160),m=n(209),p=1e3,h=.01,x=new Map,y=function(e){if(!x.has(e)){var t=new b.a((function(e){var t=1e4*Math.random();e.next(t);var n=setInterval((function(){var n=t*Math.random()*h;t+=n*(Math.random()>.5?1:-1),e.next(t)}),p);return function(){clearInterval(n)}}));x.set(e,t.pipe(Object(d.a)((function(t){return{name:e,price:t,time:new Date}})),Object(O.a)()))}return x.get(e)},g=function(e){var t;return function(n){return n.pipe(Object(m.a)((function(n,c){var a,r,u=c.price,i=c.time,l=null!==(a=null!==(r=n.open)&&void 0!==r?r:t)&&void 0!==a?a:u,s=n.max;(void 0===s||s<u)&&(s=u);var j=n.min;(void 0===j||j>u)&&(j=u);var b=Object(o.a)(Object(o.a)({},n),{},{name:c.name,open:l,close:u,max:s,min:j,time:i});return b.mapData=e(b),t=u,b}),{key:n.key}))}},C=n(148),N=n(4);function S(e){var t=e.time,n=e.open,c=e.close,a=e.min,r=e.max;return[Object(i.a)(t,"HH:mm"),a,n,c,r]}var k=function(e){var t=e.name,n=e.className,c=j((function(){return function(e,t,n){return y(e).pipe(Object(v.a)((function(e){return Object(i.a)(e.time,"yyyyMMddHHmm")})),Object(f.a)(g(n)),Object(m.a)((function(e,n){var c=Object(r.a)(e);if(0!==c.length){var a=c.length-1;c[a].key===n.key?c.splice(a,1,n):c.push(n)}else c.push(n);if(c.length>t){var u=c.length-t;c.splice(0,u)}return c}),[]))}(t,10,S)})),a=Object(u.a)(c,1)[0],o=a.data,l=a.error;if(l)return Object(N.jsx)(N.Fragment,{children:l.toString()});var s=null===o||void 0===o?void 0:o.map((function(e){return e.mapData}));return Object(N.jsx)("div",{className:n,children:s&&Object(N.jsx)(C.a,{width:"100%",height:"100%",chartType:"CandlestickChart",loader:Object(N.jsx)("div",{children:"Loading Chart"}),data:[["minute","a","b","c","d"]].concat(Object(r.a)(s)),options:{legend:"none"},rootProps:{"data-testid":"1"}})})},A=Object(a.memo)(k),R=n(150),E=n(35),L=n(29),q=function(e){return function(t){return t.order.filter((function(t){return t.name===e}))}},w=n(189),H=n(114),M=n(186),_=n(187),D=n(188),G=n(202),P=n(200),T=n(198),U=n(42),I=n(13),Q=new Map,B=function(e){var t=e.data,n=Object(E.b)(),c=Object(a.useCallback)((function(){var e;null===(e=Q.get(t.id))||void 0===e||e.next(),n(Object(I.b)({id:t.id,time:new Date}))}),[t,n]);return t.status!==L.a.PENDING?Object(N.jsx)("div",{}):Object(N.jsx)(w.a,{variant:"contained",color:"secondary",onClick:c,children:"Cancel"})},W=Object(a.memo)(B),$=function(e){var t=e.className,n=e.name,c=Object(a.useRef)(null),r=Object(a.useRef)(null),o=Object(a.useState)([]),l=Object(u.a)(o,2),s=l[0],j=l[1],b=Object(E.c)(q(n));Object(a.useEffect)((function(){var e;j(b.reverse()),null===(e=r.current)||void 0===e||e.autoSizeAllColumns()}),[b]);var d=["ag-theme-alpine"];return t&&d.push(t),Object(N.jsx)("div",{className:d.join(" "),children:Object(N.jsxs)(R.AgGridReact,{onGridReady:function(e){c.current=e.api,r.current=e.columnApi},rowData:s,frameworkComponents:{cancelOrderButton:W},children:[Object(N.jsx)(R.AgGridColumn,{field:"cancel",cellRenderer:"cancelOrderButton",headerName:"Action"}),Object(N.jsx)(R.AgGridColumn,{field:"status"}),Object(N.jsx)(R.AgGridColumn,{field:"type"}),Object(N.jsx)(R.AgGridColumn,{field:"price"}),Object(N.jsx)(R.AgGridColumn,{field:"actualPrice"}),Object(N.jsx)(R.AgGridColumn,{field:"quantity"}),Object(N.jsx)(R.AgGridColumn,{field:"createdTime",valueFormatter:function(e){var t=e.value;return Object(i.a)(t,"yyyy-MM-dd HH:mm:ss")}}),Object(N.jsx)(R.AgGridColumn,{field:"modifiedTime",valueFormatter:function(e){var t=e.value;return t?Object(i.a)(t,"yyyy-MM-dd HH:mm:ss"):""}})]})})},F=Object(a.memo)($),Y=n(208),J=n(159),V=function(e){var t=e.name,n=e.type,c=e.timing,r=e.trigger,u=e.latestPrice,i=Object(E.c)(function(e){return function(t){return t.order.filter((function(t){return t.name===e})).reduce((function(e,t){return t.type===L.d.BUY&&t.status===L.a.DONE?e+t.quantity:t.type===L.d.SELL&&t.status!==L.a.CANCELLED?e-t.quantity:e}),0)}}(t)),o=Object(a.useRef)(i);o.current=i;var l=Object(a.useRef)(t);l.current=t;var s=Object(a.useRef)(n);s.current=n;var j=Object(a.useRef)(c);j.current=c;var b=Object(a.useRef)(r);b.current=r;var d=Object(a.useRef)(u);d.current=u;var O=Object(E.b)(),v=Object(a.useRef)(null),f=Object(a.useRef)(null),m=Object(a.useCallback)((function(){var e,t,n,c,a=Number(null!==(e=null===(t=v.current)||void 0===t?void 0:t.value)&&void 0!==e?e:"0"),r=Number(null!==(n=null===(c=f.current)||void 0===c?void 0:c.value)&&void 0!==n?n:"0");if(s.current===L.d.SELL&&o.current<r)alert("Not enough stock to sell");else{var u={id:Object(J.a)(),name:l.current,type:s.current,trigger:j.current===L.b.NOW?void 0:b.current,price:j.current===L.b.NOW?d.current:a,quantity:r,status:j.current===L.b.NOW?L.a.DONE:L.a.PENDING,createdTime:new Date};j.current===L.b.NOW&&(u.actualPrice=u.price),O(Object(I.c)(u)),function(e){var t=new H.a;t.pipe(Object(M.a)((function(){Q.delete(e.id)}))),Q.set(e.id,t),y(e.name).pipe(Object(_.a)(t)).subscribe((function(n){(n.price>=e.price&&e.trigger===L.c.MORE_THAN_OR_EQUAL||n.price<=e.price&&e.trigger===L.c.LESS_THAN_OR_EQUAL)&&(U.a.dispatch(Object(I.d)({id:e.id,actualPrice:n.price,time:new Date})),t.next())}))}(u)}}),[O]);return{priceRef:v,quantityRef:f,onSubmit:m}},z=n(156),K=function(e){var t=e.text,n=e.onClick;return Object(N.jsx)(w.a,{variant:"contained",color:"primary",onClick:n,children:t})},X=Object(a.memo)(K),Z=n(203),ee=n(197),te=n(201),ne=function(e){var t=e.options,n=e.value,c=e.onChange,r=Object(a.useCallback)((function(e){null===c||void 0===c||c(e.target.value)}),[c]);return Object(N.jsx)(te.a,{value:n,onChange:r,children:t.map((function(e){return Object(N.jsx)(Z.a,{value:e.value,control:Object(N.jsx)(ee.a,{}),label:e.label},e.value)}))})},ce=Object(a.memo)(ne),ae=n(191),re=n(204),ue=n(207),ie=n(195),oe=function(e){var t=e.label,n=e.options,c=e.onChange,r=e.className,u=e.value,i=Object(a.useCallback)((function(e){null===c||void 0===c||c(e.target.value)}),[c]);return Object(N.jsxs)(ae.a,{className:r,children:[t&&Object(N.jsx)(re.a,{children:t}),Object(N.jsx)(ie.a,{value:u,onChange:i,children:n.map((function(e){return Object(N.jsx)(ue.a,{value:e.value,children:e.label},e.value)}))})]})},le=Object(a.memo)(oe),se=Object(c.a)((function(){return{reactSelect:{width:"100%"}}})),je=function(e){var t,n=e.name,c=e.className,r=se(),i=j((function(){return y(n)})),o=Object(u.a)(i,1)[0].data,l=Object(a.useState)(L.d.BUY),s=Object(u.a)(l,2),b=s[0],d=s[1],O=Object(a.useMemo)((function(){return Object.keys(L.d).map((function(e){return{label:e,value:e}}))}),[]),v=Object(a.useState)(L.b.NOW),f=Object(u.a)(v,2),m=f[0],p=f[1],h=Object(a.useMemo)((function(){return Object.keys(L.b).map((function(e){return{label:Object(z.startCase)(e.toLowerCase()),value:e}}))}),[]),x=Object(a.useState)(L.c.LESS_THAN_OR_EQUAL),g=Object(u.a)(x,2),C=g[0],S=g[1],k=Object(a.useMemo)((function(){return Object.keys(L.c).map((function(e){return{label:Object(z.startCase)(e.toLowerCase()),value:e}}))}),[]),A=Object(a.useCallback)((function(e){d(e),e===L.d.BUY?S(L.c.LESS_THAN_OR_EQUAL):S(L.c.MORE_THAN_OR_EQUAL)}),[]),R=Object(a.useCallback)((function(e){p(e)}),[]),E=Object(a.useCallback)((function(e){S(e)}),[]),q=null!==(t=null===o||void 0===o?void 0:o.price)&&void 0!==t?t:0,w=V({name:n,type:b,timing:m,trigger:C,latestPrice:q}),H=w.priceRef,M=w.quantityRef,_=w.onSubmit;return Object(N.jsxs)("div",{className:c,children:[o&&Object(N.jsx)("div",{children:"".concat(o.name,": ").concat(o.price)}),Object(N.jsx)(le,{options:O,onChange:A,className:r.reactSelect,value:b}),Object(N.jsx)(ce,{options:h,value:m,onChange:R}),m===L.b.WHEN&&Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{children:"when price is"}),Object(N.jsx)(le,{options:k,onChange:E,className:r.reactSelect,value:C}),Object(N.jsx)(Y.a,{inputRef:H,defaultValue:q})]}),Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{children:"for total of quantity"}),Object(N.jsx)(Y.a,{inputRef:M,defaultValue:1e3})]}),Object(N.jsx)(X,{text:"Submit",onClick:_})]})},be=function(e){var t,n,c,r,i,o,l,s,b=e.className,O=e.name,v=Object(E.c)(q(O)),p=Object(a.useRef)(function(){var e=new H.a,t=e.pipe(Object(m.a)((function(e){return e+1}),0)),n=e.pipe(Object(D.a)((function(e){return e.type===L.d.BUY})),Object(G.a)()),c=e.pipe(Object(D.a)((function(e){return e.type===L.d.SELL}))),a=n.pipe(Object(m.a)((function(e,t){return e+t.quantity}),0)),r=c.pipe(Object(m.a)((function(e,t){return e+t.quantity}),0),Object(P.a)(0)),i=a.pipe(Object(T.a)(r),Object(d.a)((function(e){var t=Object(u.a)(e,2);return t[0]-t[1]})),Object(P.a)(0)),o=n.pipe(Object(m.a)((function(e,t){var n;return e+t.quantity*(null!==(n=t.actualPrice)&&void 0!==n?n:0)}),0)),l=c.pipe(Object(m.a)((function(e,t){var n;return e+t.quantity*(null!==(n=t.actualPrice)&&void 0!==n?n:0)}),0),Object(P.a)(0)),s=r.pipe(Object(f.a)((function(e){return n.pipe(Object(m.a)((function(e,t){var n,c=e.sellQty,a=e.settled;if(0===c)return e;var r=t.quantity;c<t.quantity&&(r=c);var u=c-t.quantity;return u<0&&(u=0),{sellQty:u,settled:a+r*(null!==(n=t.actualPrice)&&void 0!==n?n:0)}}),{sellQty:e,settled:0}))})),Object(d.a)((function(e){return e.settled})),Object(P.a)(0)),j=o.pipe(Object(T.a)(s),Object(d.a)((function(e){var t=Object(u.a)(e,2);return t[0]-t[1]})),Object(P.a)(0));return{orderInput$:e,totalOrder$:t,summary$:i.pipe(Object(T.a)(j,l,s),Object(d.a)((function(e){var t=Object(u.a)(e,4);return{totalStocksInHand:t[0],totalStockAmount:t[1],totalSellAmount:t[2],totalSettled:t[3]}})))}}()),h=j((function(){return p.current.totalOrder$})),x=Object(u.a)(h,1)[0],y=Object(a.useRef)(x.data);y.current=x.data,Object(a.useEffect)((function(){var e,t=null!==(e=y.current)&&void 0!==e?e:0;v.filter((function(e){return e.status===L.a.DONE})).splice(t).forEach((function(e){return p.current.orderInput$.next(e)}))}),[v]);var g=j((function(){return p.current.summary$})),C=Object(u.a)(g,1)[0],S=null!==(t=null===(n=C.data)||void 0===n?void 0:n.totalStocksInHand)&&void 0!==t?t:0,k=null!==(c=null===(r=C.data)||void 0===r?void 0:r.totalStockAmount)&&void 0!==c?c:0,A=null!==(i=null===(o=C.data)||void 0===o?void 0:o.totalSellAmount)&&void 0!==i?i:0,R=null!==(l=null===(s=C.data)||void 0===s?void 0:s.totalSettled)&&void 0!==l?l:0;return Object(N.jsxs)("div",{className:b,children:[Object(N.jsxs)("div",{children:["Stocks in hand: ",S]}),Object(N.jsxs)("div",{children:["Total stock amount: ",k]}),Object(N.jsxs)("div",{children:["Average price:"," ",0===S?0:k/S]}),Object(N.jsxs)("div",{children:["Profit/Loss: ",A-R]})]})},de=Object(a.memo)(be),Oe=Object(c.a)((function(){return{quarter:{width:"50%",height:"50%"}}})),ve=function(){var e=Oe(),t="Coin A";return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(je,{className:e.quarter,name:t}),Object(N.jsx)(A,{className:e.quarter,name:t}),Object(N.jsx)(F,{className:e.quarter,name:t}),Object(N.jsx)(de,{className:e.quarter,name:t})]})};t.default=Object(a.memo)(ve)}}]);
//# sourceMappingURL=4.8a4695de.chunk.js.map